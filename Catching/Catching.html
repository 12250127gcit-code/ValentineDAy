<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catch the Ball Game</title>
<style>
  body { background:#222; color:#fff; text-align:center; font-family:sans-serif; }
  canvas { background:#333; display:block; margin:20px auto; border:2px solid #555; }
  button { padding:8px 16px; background:#444; color:white; border:none; border-radius:6px; cursor:pointer; margin:5px; }
  button:hover { background:#666; }
</style>
</head>
<body>
<h2>üéØ Catch the Falling Ball Game</h2>
<canvas id="gameCanvas" width="400" height="400"></canvas>
<button id="startBtn">Start Game</button>
<button onclick="restartGame()">Restart</button>
<p>Use ‚¨ÖÔ∏è and ‚û°Ô∏è arrow keys to move</p>

<script>
// ======== VARIABLES ========
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const startBtn = document.getElementById("startBtn");

let basket = { x: 360, y: 360, width: 100, height: 20, speed: 5 }; // moderate movement
let balls = [];
let score = 0;
let gameOver = false;
let gameRunning = false;
let keys = {};
let nextBallTime = 1; // controls timing for next ball

// ======== FUNCTIONS ========

// create a new falling ball
function createBall() {
  const x = Math.random() * (canvas.width - 20);
  const y = -20;
  const radius = 10;
  const speed = 1 + Math.random() * 1.5;
  balls.push({ x, y, radius, speed });
  // schedule next ball after 1‚Äì3 seconds
  nextBallTime = Date.now() + 5000;
}

// reset and start game
function restartGame() {
  balls = [];
  score = 0;
  gameOver = false;
  basket.x = 180;
  gameRunning = true;
  createBall();
  update();
}

// ======== EVENT LISTENERS ========

startBtn.addEventListener("click", () => {
  gameRunning = true;
  startBtn.disabled = true;
  restartGame();
});

document.addEventListener("keydown", (e) => { keys[e.key] = true; });
document.addEventListener("keyup", (e) => { keys[e.key] = false; });

// ======== DRAW FUNCTIONS ========

function drawBasket() {
  ctx.fillStyle = "red";
  ctx.fillRect(basket.x, basket.y, basket.width, basket.height);
}

function drawBalls() {
  ctx.fillStyle = "blue";
  for (const ball of balls) {
    ctx.beginPath();
    ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
    ctx.fill();
  }
}

function drawScore() {
  ctx.fillStyle = "white";
  ctx.font = "16px Arial";
  ctx.fillText("Score: " + score, 10, 20);
}

// ======== GAME LOGIC ========

function moveBasket() {
  if (keys["ArrowLeft"] && basket.x > 0) basket.x -= basket.speed;
  if (keys["ArrowRight"] && basket.x + basket.width < canvas.width) basket.x += basket.speed;
}

function updateBalls() {
  for (const ball of balls) {
    ball.y += ball.speed;

    // check collision
    if (
      ball.y + ball.radius > basket.y &&
      ball.x > basket.x &&
      ball.x < basket.x + basket.width
    ) {
      score++;
      ball.y = -20;
      ball.x = Math.random() * (canvas.width - 20);
    }

    // check if ball missed
    if (ball.y > canvas.height + 20) {
      gameOver = true;
    }
  }
}

// ======== MAIN GAME LOOP ========

function update() {
  if (!gameRunning) return;

  if (gameOver) {
    ctx.fillStyle = "red";
    ctx.font = "30px Arial";
    ctx.fillText("Game Over!", 120, 200);
    startBtn.disabled = false;
    return;
  }

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  moveBasket();
  drawBasket();
  drawBalls();
  updateBalls();
  drawScore();

  // add new ball only when time has passed
  if (Date.now() > nextBallTime) {
    createBall();
  }

  requestAnimationFrame(update);
}
</script>
</body>
</html>
